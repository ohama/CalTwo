---
phase: 05-deployment-and-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - vite.config.js
  - src/styles.css
  - src/App.fs
autonomous: true

must_haves:
  truths:
    - "Production build generates correct asset paths for /CalTwo/ subdirectory"
    - "Keyboard users see visible focus ring when tabbing through buttons"
    - "Screen reader announces button labels and display value changes"
  artifacts:
    - path: "vite.config.js"
      provides: "base: '/CalTwo/' for GitHub Pages subdirectory deployment"
      contains: "base: '/CalTwo/'"
    - path: "src/styles.css"
      provides: ":focus-visible rules for keyboard focus indicators"
      contains: "focus-visible"
    - path: "src/App.fs"
      provides: "aria-label on all buttons and role/aria-live on display"
      contains: "ariaLabel"
  key_links:
    - from: "vite.config.js"
      to: "dist/index.html"
      via: "Vite build rewrites asset paths"
      pattern: "base.*CalTwo"
    - from: "src/App.fs"
      to: "src/styles.css"
      via: ":focus-visible CSS applied to buttons with calc-button class"
      pattern: "calc-button.*focus-visible"
---

<objective>
Configure Vite for GitHub Pages deployment and add accessibility features (keyboard focus states, ARIA labels).

Purpose: Enable correct asset loading on GitHub Pages subdirectory and ensure calculator is usable by keyboard and screen reader users (WCAG 2.1 Level A).
Output: Updated vite.config.js with base path, CSS with :focus-visible rules, App.fs with aria-label attributes and live region on display.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-deployment-and-polish/05-RESEARCH.md

@vite.config.js
@src/styles.css
@src/App.fs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Vite base path and CSS focus-visible rules</name>
  <files>vite.config.js, src/styles.css</files>
  <action>
1. In vite.config.js, add `base: '/CalTwo/'` after the plugins array. This is CRITICAL for GitHub Pages — without it, all asset paths (JS, CSS) will 404 on the /CalTwo/ subdirectory.

2. In src/styles.css, add :focus-visible rules AFTER the existing .calc-backspace:active rule and BEFORE the @media query:

```css
/* Keyboard focus indicators (WCAG 2.1 SC 2.4.7) */
.calc-button:focus {
    outline: none;
}
.calc-button:focus-visible {
    outline: 3px solid #4A90E2;
    outline-offset: 2px;
}
@supports not selector(:focus-visible) {
    .calc-button:focus {
        outline: 3px solid #4A90E2;
        outline-offset: 2px;
    }
}
```

This removes the default focus ring for mouse clicks but shows a clear blue ring for keyboard navigation. The @supports fallback ensures older browsers still get focus indicators.
  </action>
  <verify>
Run `npm run build` — should complete without errors and output files to dist/ directory. Check that dist/index.html contains `/CalTwo/` in asset paths (not just `/`).
  </verify>
  <done>vite.config.js has `base: '/CalTwo/'`. styles.css has :focus-visible rules with @supports fallback. `npm run build` succeeds and asset paths in dist/ include /CalTwo/ prefix.</done>
</task>

<task type="auto">
  <name>Task 2: Add ARIA labels and live region to App.fs</name>
  <files>src/App.fs</files>
  <action>
Add accessibility attributes to the calculator view function in src/App.fs:

1. **Display div**: Add `prop.role "status"`, `prop.ariaLabel "Calculator display"`, and `prop.custom ("aria-live", "polite")` to the display div (the one with `prop.testId "display"`). This makes screen readers announce display value changes.

2. **All buttons**: Add `prop.ariaLabel` to EVERY button in the grid. Use descriptive labels:
   - C button: `prop.ariaLabel "Clear"`
   - ← button: `prop.ariaLabel "Backspace"`
   - ÷ button: `prop.ariaLabel "Divide"`
   - × button: `prop.ariaLabel "Multiply"`
   - - button: `prop.ariaLabel "Subtract"`
   - + button: `prop.ariaLabel "Add"`
   - = button: `prop.ariaLabel "Equals"`
   - . button: `prop.ariaLabel "Decimal point"`
   - 0-9 buttons: `prop.ariaLabel "0"` through `prop.ariaLabel "9"` (the number itself is sufficient)

   Place `prop.ariaLabel` BEFORE `prop.text` in each button's property list.

Important: Do NOT change the prop.text, prop.className, prop.onClick, or any other existing properties. Only ADD ariaLabel to each button and accessibility attributes to the display div.
  </action>
  <verify>
Run `npm run build` — should complete without errors. Run `npm test` — all 33 unit tests should still pass. Verify by reading src/App.fs that every Html.button has prop.ariaLabel and the display div has role="status".
  </verify>
  <done>Every button in the calculator grid has a descriptive aria-label. Display div has role="status", ariaLabel, and aria-live="polite". All existing tests pass unchanged.</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds and dist/ contains files
2. `grep -r "CalTwo" dist/index.html` shows /CalTwo/ in asset paths
3. `npm test` — all 33 unit tests pass
4. `grep "ariaLabel" src/App.fs` — shows aria labels on buttons
5. `grep "focus-visible" src/styles.css` — shows focus indicator rules
</verification>

<success_criteria>
- Production build succeeds with correct /CalTwo/ base path in asset URLs
- All buttons have descriptive aria-label attributes
- Display has role="status" and aria-live="polite" for screen reader announcements
- :focus-visible CSS provides keyboard-only focus indicators
- All existing unit tests pass unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/05-deployment-and-polish/05-01-SUMMARY.md`
</output>
